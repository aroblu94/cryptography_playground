#include <stdio.h>
#include <gmp.h>

int main(void) {
	// n of Key A is built from too near p and q.
	// Find p,q;

	mpz_t key,a,b,p,q;
	mpz_inits(key,a,b,p,q,NULL);
	mpz_set_str(key,"21908146828306433444146575701361975985124014312140437430786574540973375665834757036173282570833278685418280441083485043968880549317177814973482046597450269750819773291280737646344882008294463367399610583290185161148519709630860658351876273887065498117047602599866246285820192725205605663184052820919147703515982693132687299195290954512368653349279551623361733443716306139421400719719595075223835403066187434727338406066826489308565344261720814311637456008015758670445581312431708784392470867175170067770218582742097683873205212946609469263268681064583650184849740754990593286834462998763434704483041567259369903770913",10);

	// Let's crack p,q with Fermat
	mpz_sqrt(a,key);

	mpz_pow_ui(b,a,2);
	mpz_sub(b,b,key);
	while(!mpz_perfect_power_p(b)) {
		mpz_add_ui(a,a,1);
		mpz_pow_ui(b,a,2);
		mpz_sub(b,b,key);
	}
	mpz_sqrt(b,b);
	mpz_sub(p,a,b);
	mpz_add(q,a,b);
	gmp_printf("P: %Zd\nQ: %Zd\n",p,q);

	mpz_mul(a,p,q);
	if(mpz_cmp(key,a)==0)
		printf("OK\n");

	return 0;
}